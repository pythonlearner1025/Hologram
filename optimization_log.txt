E0630 23:33:53.576098  100610 ptx_compiler_helpers.cc:87] *** WARNING *** Invoking ptxas with version 12.4.131, which corresponds to a CUDA version <=12.6.2. CUDA versions 12.x.y up to and including 12.6.2 miscompile certain edge cases around clamping.
Please upgrade to CUDA 12.6.3 or newer.
Grid configuration:
  Grid size: (200, 500) voxels
  Grid spacing: 0.1 mm
  Domain size: 20 x 50 mm

Lens configuration:
  Number of lenses: 4
  Segments per lens: 300
  Total parameters: 1200

============================================================
OPTIMIZED STACKED LENS OPTIMIZATION
============================================================
Key optimizations enabled:
  - Vectorized sound speed map generation
  - Cached Helmholtz solver compilation
  - Optax AdamW optimizer
  - Mixed precision (bfloat16)
============================================================
Using objective: objective_sidelobe
Running 50 iterations...

Warming up JIT compilation...
JIT compilation complete!

Iter   0: Loss = -0.194220, Time = 2.28s
Iter  10: Loss = -0.302710, Time = 2.28s
Iter  20: Loss = -0.357268, Time = 2.22s
Iter  30: Loss = -0.380737, Time = 2.22s
Iter  40: Loss = -0.391967, Time = 2.23s

Optimization complete in 128.8s
Average time per iteration: 2.58s
Final loss: -0.397708
Improvement: 104.8%
Binarization: 64.8% of segments are nearly binary

Saving results...
Exported lens 1 design to /workspace/hologram/outs/stacked_opt_20250630_233353/lens_1_design.csv
Exported lens 2 design to /workspace/hologram/outs/stacked_opt_20250630_233353/lens_2_design.csv
Exported lens 3 design to /workspace/hologram/outs/stacked_opt_20250630_233353/lens_3_design.csv
Exported lens 4 design to /workspace/hologram/outs/stacked_opt_20250630_233353/lens_4_design.csv

All results saved to: /workspace/hologram/outs/stacked_opt_20250630_233353
